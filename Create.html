<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Chaos Admin Panel</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: #050505;
        font-family: monospace;
        color: white;
    }
    canvas { display: block; }

    #panel {
        position: fixed;
        top: 10px;
        left: 10px;
        width: 220px;
        background: rgba(0,0,0,0.85);
        border: 1px solid #444;
        padding: 10px;
        display: none;
    }

    #panel h3 {
        margin: 5px 0;
        font-size: 14px;
        border-bottom: 1px solid #333;
    }

    button, select, input {
        width: 100%;
        margin: 5px 0;
        background: #111;
        color: #ccc;
        border: 1px solid #555;
    }
</style>
</head>
<body>

<canvas id="c"></canvas>

<div id="panel">
    <h3>ADMIN PANEL</h3>

    <button onclick="togglePause()">Pause / Play</button>
    <button onclick="clearWorld()">Reset Monde</button>

    <h3>Gravité</h3>
    <input type="range" min="-2" max="2" step="0.1" value="0" oninput="gravity.x=this.value">
    <input type="range" min="-2" max="2" step="0.1" value="0.6" oninput="gravity.y=this.value">

    <h3>Création</h3>
    <select onchange="mode=this.value">
        <option value="normal">Normal</option>
        <option value="spray">Spray</option>
        <option value="giant">Géant</option>
        <option value="chaos">Chaos</option>
    </select>

    <button onclick="wtfMode=!wtfMode">WTF Permanent</button>
</div>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
resize();
window.addEventListener("resize", resize);

function resize() {
    canvas.width = innerWidth;
    canvas.height = innerHeight;
}

let gravity = { x: 0, y: 0.6 };
let balls = [];
let paused = false;
let mode = "normal";
let wtfMode = false;

let mouse = { x: 0, y: 0, down: false };
let grabbed = null;

class Ball {
    constructor(x, y, r = Math.random()*12+12) {
        this.x = x;
        this.y = y;
        this.vx = (Math.random()-0.5)*10;
        this.vy = (Math.random()-0.5)*10;
        this.r = r;
        this.color = `hsl(${Math.random()*360},80%,60%)`;
    }

    update() {
        if (grabbed === this && mouse.down) {
            this.x = mouse.x;
            this.y = mouse.y;
            this.vx = this.vy = 0;
            return;
        }

        this.vx += gravity.x;
        this.vy += gravity.y;

        this.x += this.vx;
        this.y += this.vy;

        if (this.x-this.r < 0 || this.x+this.r > canvas.width) this.vx *= -0.9;
        if (this.y-this.r < 0 || this.y+this.r > canvas.height) this.vy *= -0.9;
    }

    draw() {
        ctx.beginPath();
        ctx.arc(this.x,this.y,this.r,0,Math.PI*2);
        ctx.fillStyle = this.color;
        ctx.fill();
    }
}

function collide() {
    for (let i=0;i<balls.length;i++) {
        for (let j=i+1;j<balls.length;j++) {
            let a=balls[i], b=balls[j];
            let dx=b.x-a.x, dy=b.y-a.y;
            let d=Math.hypot(dx,dy);
            if (d < a.r+b.r) {
                let nx=dx/d, ny=dy/d;
                let p=0.5;
                a.vx-=nx*p; a.vy-=ny*p;
                b.vx+=nx*p; b.vy+=ny*p;
            }
        }
    }
}

function create(x,y) {
    if (mode==="normal") balls.push(new Ball(x,y));
    if (mode==="spray") for(let i=0;i<5;i++) balls.push(new Ball(x,y));
    if (mode==="giant") balls.push(new Ball(x,y,50));
    if (mode==="chaos") {
        let b=new Ball(x,y);
        b.vx*=3; b.vy*=3;
        balls.push(b);
    }
}

canvas.addEventListener("mousedown", e => {
    mouse.down=true;
    mouse.x=e.clientX; mouse.y=e.clientY;

    for(let i=balls.length-1;i>=0;i--){
        let b=balls[i];
        if(Math.hypot(mouse.x-b.x,mouse.y-b.y)<b.r){
            grabbed=b; return;
        }
    }
    create(mouse.x,mouse.y);
});

canvas.addEventListener("mousemove", e=>{
    mouse.x=e.clientX; mouse.y=e.clientY;
});

canvas.addEventListener("mouseup", ()=>{
    mouse.down=false;
    grabbed=null;
});

function togglePause(){ paused=!paused; }
function clearWorld(){ balls=[]; }

setInterval(()=>{
    if(wtfMode){
        gravity.x=(Math.random()-0.5)*2;
        gravity.y=(Math.random()-0.5)*2;
    }
},2000);

document.addEventListener("keydown", e=>{
    if(e.key===" ") togglePause();
    if(e.key.toLowerCase()==="a"){
        const p=document.getElementById("panel");
        p.style.display = p.style.display==="none"?"block":"none";
    }
});

function loop(){
    if(!paused){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        balls.forEach(b=>b.update());
        collide();
        balls.forEach(b=>b.draw());
    }
    requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
